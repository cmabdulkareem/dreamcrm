import{r as g,A as D,j as e,P as k,C as L,z as i,K as N,I as b,L as w,o as C,y as r,c as S,d as q}from"./index-BRRNp47y.js";const T=()=>{const{user:c}=g.useContext(D),[a,u]=g.useState({leaveType:"casual",startDate:"",endDate:"",reason:""}),[x,y]=g.useState(!1),m=s=>{const{name:n,value:o}=s.target;u(d=>({...d,[n]:o}))},f=(s,n)=>{u(o=>({...o,[s]:n}))},p=()=>{u({leaveType:"casual",startDate:"",endDate:"",reason:""})},j=async s=>{var v,h;if(s.preventDefault(),!c){r.error("User information not found.");return}if(!a.leaveType||!a.startDate||!a.endDate||!a.reason){r.error("Please fill in all required fields");return}const n=new Date(a.startDate),o=new Date(a.endDate),d=new Date;if(d.setHours(0,0,0,0),n>o){r.error("Start date cannot be after end date");return}if(n<d){r.error("Start date cannot be in the past");return}try{y(!0);const t={employeeName:c.fullName||"Unknown",employeeCode:c.employeeCode||"N/A",leaveType:a.leaveType,startDate:n.toISOString(),endDate:o.toISOString(),reason:a.reason.trim()},l=await S.post(`${q}/leaves/create`,t,{timeout:1e4});l.data&&l.data.message?r.success(l.data.message||"Leave request submitted successfully!"):r.success("Leave request submitted successfully!"),p()}catch(t){if(console.error("Error submitting leave request:",t),t.response){const l=((v=t.response.data)==null?void 0:v.message)||((h=t.response.data)!=null&&h.errors?t.response.data.errors.join(", "):"Failed to submit leave request");r.error(l)}else t.request?r.error("Network error. Please check your connection."):r.error("Failed to submit leave request. Please try again.")}finally{y(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(k,{title:"Apply for Leave - CRM"}),e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsxs(L,{title:"Apply for Leave",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Fill out the form below to submit a new leave request."}),e.jsx("form",{onSubmit:j,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"leaveType",children:"Leave Type *"}),e.jsx(N,{options:[{value:"casual",label:"Casual Leave"},{value:"sick",label:"Sick Leave"},{value:"annual",label:"Annual Leave"},{value:"maternity",label:"Maternity Leave"},{value:"paternity",label:"Paternity Leave"}],value:a.leaveType,onChange:s=>f("leaveType",s)})]}),e.jsx("div",{})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"startDate",children:"Start Date *"}),e.jsx(b,{type:"date",id:"startDate",name:"startDate",value:a.startDate,onChange:m,required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"endDate",children:"End Date *"}),e.jsx(b,{type:"date",id:"endDate",name:"endDate",value:a.endDate,onChange:m,required:!0})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"reason",children:"Reason for Leave *"}),e.jsx("textarea",{id:"reason",name:"reason",value:a.reason,onChange:m,rows:"4",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-hidden focus:ring-3 focus:ring-brand-500/20 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 bg-transparent text-gray-800 focus:border-brand-300 dark:border-gray-700 dark:focus:border-brand-800 rounded-lg shadow-theme-xs",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"reset",onClick:p,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-600",children:"Reset"}),e.jsx("button",{type:"submit",disabled:x,className:"px-4 py-2 bg-brand-500 text-white rounded-md hover:bg-brand-600 disabled:opacity-50",children:x?"Submitting...":"Submit Request"})]})]})}),e.jsx("div",{className:"mt-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Want to check your leave usage?"," ",e.jsx(w,{to:"/leave-management/my-leaves",className:"text-brand-500 dark:text-brand-400 hover:underline",children:"View My Leaves"})]})})]})}),e.jsx(C,{position:"top-center",className:"!z-[999999]",style:{zIndex:999999}})]})};export{T as default};
