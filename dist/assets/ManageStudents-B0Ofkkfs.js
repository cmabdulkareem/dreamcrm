import{b as D,r as i,A as _,u as E,c as h,d as m,y as x,j as e,P as I,s as A,B as P,C as $,x as M}from"./index-BXfYerbG.js";function T(){const y=D(),{user:d}=i.useContext(_),{addNotification:f,areToastsEnabled:g}=E(),[o,c]=i.useState([]),[j,p]=i.useState(!0),[r,u]=i.useState(null),[s,l]=i.useState({});i.useEffect(()=>{N()},[]);const N=async()=>{try{p(!0);const t=await h.get(`${m}/students/all`,{withCredentials:!0});c(t.data.students),p(!1)}catch(t){console.error("Error fetching students:",t),c([{_id:"1",studentId:"STU001",fullName:"John Doe",email:"john@example.com",phone1:"+1 234 567 8900",coursePreference:"Graphic Design",enrollmentDate:"2025-01-15",status:"Active",photo:null},{_id:"2",studentId:"STU002",fullName:"Jane Smith",email:"jane@example.com",phone1:"+1 234 567 8901",coursePreference:"Interior Design",enrollmentDate:"2025-01-20",status:"Active",photo:null}]),x.info("Using demo data for demonstration"),p(!1)}},w=()=>{y("/new-student")},k=t=>{x.info(`Viewing student ${t}`)},v=t=>{u(t._id),l({...t})},b=()=>{u(null),l({})},n=(t,a)=>{l({...s,[a]:t.target.value})},C=async()=>{try{const t=await h.put(`${m}/students/update/${r}`,s,{withCredentials:!0});c(o.map(a=>a._id===r?t.data.student:a)),u(null),l({}),g()&&x.success("Student updated successfully!"),f({type:"student_updated",userName:(d==null?void 0:d.fullName)||"Someone",avatar:(d==null?void 0:d.avatar)||null,action:"updated student",entityName:t.data.student.fullName,module:"Student Management"})}catch(t){console.error("Error updating student:",t),g()&&x.error("Failed to update student. Please try again.")}},S=t=>t?t.startsWith("http")?t:`${m.replace("/api","")}${t}`:"/images/user/user-01.jpg";return e.jsxs("div",{children:[e.jsx(I,{title:"Manage Students | DreamCRM",description:"Manage your students here"}),e.jsx(A,{pageTitle:"Manage Students"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(P,{variant:"primary",onClick:w,children:"Add New Student"})}),e.jsx($,{title:"Student List",children:j?e.jsx("div",{className:"flex justify-center items-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-white"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Photo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Student ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Phone"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Course"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Total Value"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Discount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Final Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Enrollment Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200 dark:bg-gray-900 dark:divide-gray-700",children:o.length>0?o.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("img",{className:"h-10 w-10 rounded-full object-cover border-2 border-gray-200 dark:border-gray-700",src:S(t.photo),alt:t.fullName,onError:a=>{a.target.src="/images/user/user-01.jpg"}})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:r===t._id?e.jsx("input",{type:"text",value:s.studentId||"",onChange:a=>n(a,"studentId"),className:"w-full px-2 py-1 border rounded"}):t.studentId}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:r===t._id?e.jsx("input",{type:"text",value:s.fullName||"",onChange:a=>n(a,"fullName"),className:"w-full px-2 py-1 border rounded"}):t.fullName}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:r===t._id?e.jsx("input",{type:"email",value:s.email||"",onChange:a=>n(a,"email"),className:"w-full px-2 py-1 border rounded"}):t.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:r===t._id?e.jsx("input",{type:"text",value:s.phone1||"",onChange:a=>n(a,"phone1"),className:"w-full px-2 py-1 border rounded"}):t.phone1}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:r===t._id?e.jsx("input",{type:"text",value:s.coursePreference||"",onChange:a=>n(a,"coursePreference"),className:"w-full px-2 py-1 border rounded"}):e.jsxs("div",{children:[t.courseDetails?`${t.courseDetails.courseCode} - ${t.courseDetails.courseName}`:t.coursePreference,t.additionalCourseDetails&&t.additionalCourseDetails.length>0&&e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["+",t.additionalCourseDetails.length," additional course(s)"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:r===t._id?e.jsx("input",{type:"number",value:s.totalCourseValue||"",onChange:a=>n(a,"totalCourseValue"),className:"w-full px-2 py-1 border rounded"}):`₹${t.totalCourseValue||0}`}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:r===t._id?e.jsx("input",{type:"number",value:s.discountPercentage||"",onChange:a=>n(a,"discountPercentage"),className:"w-full px-2 py-1 border rounded"}):`${t.discountPercentage||0}%`}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:r===t._id?e.jsx("input",{type:"number",value:s.finalAmount||"",onChange:a=>n(a,"finalAmount"),className:"w-full px-2 py-1 border rounded"}):`₹${t.finalAmount||0}`}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:r===t._id?e.jsx("input",{type:"date",value:s.enrollmentDate?new Date(s.enrollmentDate).toISOString().split("T")[0]:"",onChange:a=>n(a,"enrollmentDate"),className:"w-full px-2 py-1 border rounded"}):new Date(t.enrollmentDate).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100",children:"Active"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:r===t._id?e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:C,className:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300",children:"Save"}),e.jsx("button",{onClick:b,className:"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300",children:"Cancel"})]}):e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>v(t),className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300",children:"Edit"}),e.jsx("button",{onClick:()=>k(t.studentId),className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300",children:"View"})]})})]},t._id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400",children:"No students found"})})})]})})})]}),e.jsx(M,{position:"top-center",className:"!z-[999999]",style:{zIndex:999999}})]})}export{T as default};
