import{ad as d,b as I,c,j as e,M as $}from"./index-BNEGGE57.js";const O=({isOpen:n,onClose:i,student:r})=>{var b,y,u,j,f,N,k,v,w,S,D,C;const[R,o]=d.useState(null),[B,x]=d.useState(!1),[p,g]=d.useState([]),[E,m]=d.useState(!1),L=()=>{window.print()};d.useEffect(()=>{n&&r?(M(),F()):(o(null),g([]))},[n,r]);const M=async()=>{try{x(!0);const t=r.studentId&&typeof r.studentId=="object"&&r.studentId._id?r.studentId._id:r._id,s=await I.get(`${c}/students/${t}`,{withCredentials:!0});o(s.data.student)}catch(t){console.error("Failed to fetch student details:",t)}finally{x(!1)}},F=async()=>{try{m(!0);const t=r.studentId&&typeof r.studentId=="object"&&r.studentId._id?r.studentId._id:r._id||r.id,s=await I.get(`${c}/invoices?customer=${t}`,{withCredentials:!0});g(s.data)}catch(t){console.error("Failed to fetch invoices:",t)}finally{m(!1)}};if(!r)return null;const a=R||r,h=t=>t?t.startsWith("http")||t.startsWith("data:")?t:`${c.replace("/api","")}${t}`:"/images/user/user-01.jpg",l=t=>t?new Date(t).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"}):"-";return e.jsxs($,{isOpen:n,onClose:i,showCloseButton:!0,className:"max-w-5xl !p-0 overflow-hidden bg-white dark:bg-gray-900 shadow-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center px-6 py-3 border-b border-gray-100 dark:border-gray-800 bg-gray-50 dark:bg-gray-800 print:hidden",children:[e.jsx("h2",{className:"text-sm font-bold text-gray-700 dark:text-gray-300 uppercase tracking-widest",children:"Student Profile Viewer"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:L,className:"flex items-center gap-2 px-4 py-1.5 bg-brand-500 hover:bg-brand-600 text-white rounded-lg text-xs font-bold transition-colors shadow-sm",children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"PRINT REPORT"]}),e.jsx("button",{onClick:i,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200",children:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]}),e.jsx("div",{className:"max-h-[85vh] overflow-y-auto custom-scrollbar bg-gray-100/50 dark:bg-gray-900/50 p-4 sm:p-8",id:"report-print-area",children:e.jsxs("div",{className:"w-full max-w-[210mm] mx-auto bg-white dark:bg-gray-900 shadow-xl border border-gray-200 dark:border-gray-800 rounded-sm overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 sm:p-8 border-b-4 border-brand-500 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-brand-500/5 rounded-full -mr-32 -mt-32"}),e.jsxs("div",{className:"relative flex flex-col sm:flex-row justify-between items-start gap-4",children:[e.jsxs("div",{className:"flex gap-6 items-center",children:[(b=a.brand)!=null&&b.logo?e.jsx("img",{src:h(a.brand.logo),alt:"Brand Logo",className:"h-20 w-auto object-contain"}):e.jsx("div",{className:"h-20 w-20 bg-brand-500 rounded-2xl flex items-center justify-center text-white text-4xl font-black shadow-lg shadow-brand-200",children:((u=(y=a.brand)==null?void 0:y.name)==null?void 0:u.charAt(0))||"D"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black text-gray-900 dark:text-white uppercase tracking-tighter leading-none",children:((j=a.brand)==null?void 0:j.name)||"DREAM CRM"}),e.jsxs("div",{className:"mt-2 text-[11px] text-gray-500 dark:text-gray-400 font-medium uppercase tracking-widest leading-relaxed max-w-[300px]",children:[((f=a.brand)==null?void 0:f.address)||"Official Training Partner",((N=a.brand)==null?void 0:N.phone)&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"Contact: ",a.brand.phone]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("h2",{className:"text-3xl font-light text-gray-300 dark:text-gray-700 uppercase tracking-[0.2em] mb-1",children:"REPORT"}),e.jsx("div",{className:"inline-block px-3 py-1 bg-gray-900 text-white dark:bg-white dark:text-gray-900 text-[10px] font-black uppercase tracking-[0.3em] rounded-sm",children:"Official Document"})]})]})]}),e.jsxs("div",{className:"p-6 sm:p-8 flex-grow flex flex-col gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white uppercase tracking-[0.5em] mb-8 border-b border-gray-100 dark:border-gray-800 pb-4",children:"Student Progress Report"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 print:grid-cols-4 gap-8 items-center text-left",children:[e.jsx("div",{className:"flex justify-center md:justify-start print:justify-start",children:e.jsx("img",{src:h(a.photo),alt:a.fullName,className:"h-32 w-32 rounded-sm object-cover border-4 border-gray-50 dark:border-gray-800 shadow-md gray-scale",onError:t=>{t.target.src="/images/user/user-01.jpg"}})}),e.jsxs("div",{className:"md:col-span-3 print:col-span-3 grid grid-cols-2 gap-y-4 gap-x-12",children:[e.jsxs("div",{className:"space-y-0.5 border-b border-gray-50 dark:border-gray-800 pb-2",children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:"Student Name"}),e.jsx("p",{className:"text-lg font-black text-gray-900 dark:text-white uppercase",children:a.fullName})]}),e.jsxs("div",{className:"space-y-0.5 border-b border-gray-50 dark:border-gray-800 pb-2 text-right",children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:"Student ID"}),e.jsx("p",{className:"text-lg font-mono font-black text-brand-600",children:a.studentId})]}),e.jsxs("div",{className:"space-y-0.5 border-b border-gray-50 dark:border-gray-800 pb-2",children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:"Enrollment Date"}),e.jsx("p",{className:"text-sm font-bold text-gray-700 dark:text-gray-300",children:l(a.enrollmentDate)})]}),e.jsxs("div",{className:"space-y-0.5 border-b border-gray-50 dark:border-gray-800 pb-2",children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:"Current Status"}),e.jsx("p",{className:"text-sm font-bold text-gray-700 dark:text-gray-300 uppercase",children:a.status||"Active"})]}),e.jsx("div",{className:"space-y-0.5 border-b border-gray-50 dark:border-gray-800 pb-2 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:"Average Attendance"}),e.jsxs("span",{className:`text-md font-black ${parseFloat(a.averageAttendance)>=75?"text-green-600":"text-red-600"}`,children:[a.averageAttendance||"0.00","%"]}),e.jsx("div",{className:"w-24 h-1.5 bg-gray-100 dark:bg-gray-800 rounded-full mt-1 overflow-hidden",children:e.jsx("div",{className:`h-full ${parseFloat(a.averageAttendance)>=75?"bg-green-500":"bg-red-500"}`,style:{width:`${a.averageAttendance||0}%`}})})]})})]})]})]}),e.jsxs("section",{children:[e.jsx("h4",{className:"text-[11px] font-black text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-800 px-4 py-2 uppercase tracking-[0.2em] mb-4 border-l-4 border-brand-500",children:"Bio-Data & Contact Records"}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-x-12 gap-y-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest",children:"Email Address"}),e.jsx("p",{className:"text-xs font-bold text-gray-800 dark:text-gray-200",children:a.email||"-"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest",children:"Primary Contact"}),e.jsx("p",{className:"text-xs font-bold text-gray-800 dark:text-gray-200",children:a.phone1||"-"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest",children:"Date of Birth"}),e.jsx("p",{className:"text-xs font-bold text-gray-800 dark:text-gray-200",children:l(a.dob)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest",children:"Gender"}),e.jsx("p",{className:"text-xs font-bold text-gray-800 dark:text-gray-200 uppercase",children:a.gender||"-"})]}),e.jsxs("div",{className:"space-y-1 col-span-2",children:[e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest",children:"Permanent Address"}),e.jsx("p",{className:"text-xs font-medium text-gray-800 dark:text-gray-200 leading-relaxed italic",children:a.address||"-"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest",children:"Place / Region"}),e.jsx("p",{className:"text-xs font-bold text-gray-800 dark:text-gray-200 uppercase",children:a.place==="Other"?a.otherPlace:a.place})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest",children:"Identification (Aadhar)"}),e.jsx("p",{className:"text-xs font-bold text-gray-800 dark:text-gray-200",children:a.aadharCardNumber||"-"})]})]})]}),e.jsxs("section",{children:[e.jsx("h4",{className:"text-[11px] font-black text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-800 px-4 py-2 uppercase tracking-[0.2em] mb-4 border-l-4 border-brand-500",children:"Academic Curriculum"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"p-4 border border-gray-100 dark:border-gray-800 rounded-sm",children:[e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest",children:"Primary Specialization"}),e.jsx("p",{className:"text-md font-black text-gray-800 dark:text-gray-200 mt-1 uppercase",children:a.courseDetails?`${a.courseDetails.courseCode} - ${a.courseDetails.courseName}`:a.coursePreference}),e.jsxs("div",{className:"mt-2 text-[11px] text-gray-500 flex gap-4 font-bold",children:[e.jsxs("span",{children:["Duration: ",((k=a.courseDetails)==null?void 0:k.duration)||"-"," Months"]}),e.jsxs("span",{children:["Mode: ",((v=a.courseDetails)==null?void 0:v.mode)||"-"]})]})]}),a.additionalCourseDetails&&a.additionalCourseDetails.length>0&&e.jsxs("div",{className:"p-4 border border-gray-100 dark:border-gray-800 rounded-sm",children:[e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest",children:"Additional Modules"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:a.additionalCourseDetails.map((t,s)=>e.jsxs("span",{className:"text-[10px] bg-gray-100 dark:bg-gray-800 font-bold px-2 py-1 border border-gray-200 dark:border-gray-700",children:[t.courseCode," - ",t.courseName]},s))})]})]})]}),e.jsxs("section",{children:[e.jsx("h4",{className:"text-[11px] font-black text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-800 px-4 py-2 uppercase tracking-[0.2em] mb-4 border-l-4 border-brand-500",children:"Attendance & Performance Summary"}),a.batchHistory&&a.batchHistory.length>0?e.jsx("div",{className:"overflow-hidden border border-gray-100 dark:border-gray-800 rounded-sm",children:e.jsxs("table",{className:"w-full text-left text-[11px]",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 uppercase text-gray-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-black",children:"Batch Name"}),e.jsx("th",{className:"px-4 py-3 font-black",children:"Subject / Module"}),e.jsx("th",{className:"px-4 py-3 font-black",children:"Instructor"}),e.jsx("th",{className:"px-4 py-3 font-black text-center",children:"Attendance"}),e.jsx("th",{className:"px-4 py-3 font-black text-right",children:"Score"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-800",children:a.batchHistory.map((t,s)=>e.jsxs("tr",{className:"text-gray-700 dark:text-gray-300",children:[e.jsx("td",{className:"px-4 py-3 font-bold",children:t.batchName}),e.jsx("td",{className:"px-4 py-3",children:t.subject}),e.jsx("td",{className:"px-4 py-3",children:t.instructorName||"N/A"}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsxs("span",{className:`px-2 py-0.5 rounded-full font-bold ${parseFloat(t.attendancePercentage)>=75?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[t.attendancePercentage,"%"]})}),e.jsx("td",{className:"px-4 py-3 text-right font-bold",children:"-"})]},s))})]})}):e.jsx("div",{className:"p-8 text-center border border-dashed border-gray-200 dark:border-gray-800 rounded-sm italic text-gray-400 text-xs",children:"No batch history records available for this period."})]}),e.jsxs("section",{children:[e.jsx("h4",{className:"text-[11px] font-black text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-800 px-4 py-2 uppercase tracking-[0.2em] mb-4 border-l-4 border-brand-500",children:"Official Financial Statement"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 print:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"md:col-span-2 print:col-span-2 grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800/50",children:[e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Fee Calculation Basis"}),e.jsx("p",{className:"text-md font-black text-gray-800 mt-1 uppercase",children:a.feeType==="singleShot"?"Single Shot Payment Plan":"Standard Installment Plan"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800/50 text-right",children:[e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Discount Category"}),e.jsx("p",{className:"text-md font-black text-gray-800 mt-1 italic",children:a.discountPercentage>0?`PROMOTIONAL (${a.discountPercentage}%)`:"NONE"})]}),e.jsxs("div",{className:"col-span-2 p-4 border border-gray-100 dark:border-gray-800",children:[e.jsxs("div",{className:"flex justify-between text-xs font-bold py-1",children:[e.jsx("span",{className:"text-gray-500 uppercase",children:"Gross Course Value"}),e.jsxs("span",{className:"text-gray-900",children:["₹",(w=a.totalCourseValue)==null?void 0:w.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between text-xs font-bold py-1 border-b border-gray-50 pb-2",children:[e.jsx("span",{className:"text-red-500 uppercase",children:"Scholarship / Discount"}),e.jsxs("span",{className:"text-red-500",children:["- ₹",(S=a.discountAmount)==null?void 0:S.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between text-md font-black py-3",children:[e.jsx("span",{className:"text-gray-900 uppercase",children:"Net Amount Payable"}),e.jsxs("span",{className:"text-brand-600",children:["₹",(D=a.finalAmount)==null?void 0:D.toLocaleString()]})]})]})]}),e.jsxs("div",{className:"flex flex-col justify-center items-center p-6 border-2 border-brand-500/20 bg-brand-500/5 rounded-sm text-center",children:[e.jsx("span",{className:"text-[10px] font-bold text-brand-600 uppercase tracking-widest mb-2 font-mono",children:"Current Status"}),e.jsx("div",{className:"w-16 h-16 rounded-full border-4 border-brand-500 flex items-center justify-center mb-2",children:e.jsx("svg",{className:"h-8 w-8 text-brand-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})})}),e.jsx("span",{className:"text-xl font-black text-gray-900 uppercase",children:"Registered"}),e.jsx("span",{className:"text-[10px] text-gray-400 mt-1 font-mono",children:l(new Date)})]})]})]}),e.jsxs("section",{className:"pt-4",children:[e.jsx("h4",{className:"text-[11px] font-black text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-800 px-4 py-2 uppercase tracking-[0.2em] mb-4 border-l-4 border-brand-500",children:"Recent Payment History / Invoices"}),p.length>0?e.jsx("div",{className:"overflow-hidden border border-gray-100 dark:border-gray-800 rounded-sm",children:e.jsxs("table",{className:"w-full text-left text-[11px]",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 uppercase text-gray-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-black",children:"Date"}),e.jsx("th",{className:"px-4 py-3 font-black",children:"Invoice Number"}),e.jsx("th",{className:"px-4 py-3 font-black",children:"Description"}),e.jsx("th",{className:"px-4 py-3 font-black text-center",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-black text-right",children:"Amount Paid"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-800",children:p.map(t=>{var s,A,P;return e.jsxs("tr",{className:"text-gray-700 dark:text-gray-300",children:[e.jsx("td",{className:"px-4 py-3",children:new Date(t.invoiceDate).toLocaleDateString()}),e.jsxs("td",{className:"px-4 py-3 font-bold",children:["#",t.invoiceNumber]}),e.jsx("td",{className:"px-4 py-3 uppercase text-[10px]",children:((A=(s=t.items)==null?void 0:s[0])==null?void 0:A.description)||"Course Fees"}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("span",{className:`px-2 py-0.5 rounded-full font-bold uppercase text-[9px] ${t.status==="Paid"?"bg-green-50 text-green-600":"bg-amber-50 text-amber-600"}`,children:t.status})}),e.jsxs("td",{className:"px-4 py-3 text-right font-black",children:["₹",(P=t.totalAmount)==null?void 0:P.toLocaleString()]})]},t._id)})})]})}):e.jsx("div",{className:"p-8 text-center border border-dashed border-gray-200 dark:border-gray-800 rounded-sm italic text-gray-400 text-xs",children:"No financial transactions or invoices recorded yet."})]}),e.jsxs("div",{className:"mt-8 grid grid-cols-2 gap-20",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"border-b border-gray-300 h-16 mb-2"}),e.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Student Signature"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"border-b border-gray-300 h-16 mb-2 relative",children:e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 border-2 border-brand-500/20 rounded-full flex items-center justify-center opacity-10 -rotate-12 translate-x-4 -translate-y-4",children:e.jsxs("span",{className:"text-[8px] font-black text-brand-500 text-center uppercase tracking-tighter",children:["Dream CRM",e.jsx("br",{}),"Official Seal"]})})}),e.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Authorized Signatory"})]})]})]}),e.jsx("div",{className:"bg-gray-900 text-white p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[e.jsx("div",{className:"text-[9px] font-black uppercase tracking-[0.3em] opacity-50",children:"Generated Automatically via Dream CRM Systems"}),e.jsxs("div",{className:"text-[10px] font-medium opacity-80 flex gap-4",children:[e.jsxs("span",{children:["Report Ref: ",a.studentId,"-",new Date().getFullYear()]}),e.jsx("span",{children:"|"}),e.jsxs("span",{children:["© ",new Date().getFullYear()," ",((C=a.brand)==null?void 0:C.name)||"Dream CRM"]})]})]})})]})}),e.jsx("style",{dangerouslySetInnerHTML:{__html:`
@media print {
    @page {
        margin: 0;
        size: A4;
    }
    body {
        margin: 0;
        padding: 0;
        background: white !important;
        transform: scale(0.95);
        transform-origin: top left;
        width: 100%;
        height: 100%;
    }

    /* Force background colors and grayscale */
    * {
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
    }

    /* Hide everything except report area */
    body * {
        visibility: hidden !important;
    }

    #report-print-area, #report-print-area * {
        visibility: visible !important;
    }

    #report-print-area {
        position: fixed !important;
        left: 0 !important;
        top: 0 !important;
        width: 100% !important;
        height: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        background: white !important;
        z-index: 2147483647 !important;
        overflow: visible !important;
    }

    .print\\:hidden {
        display: none !important;
    }



    /* Custom scrollbar reset */
    .custom-scrollbar::-webkit-scrollbar {
        display: none;
    }
}
`}})]})};export{O as S};
