import{r as o,b as I,c as L,d as D,j as e,n as C,B as F,T as U,p as M,q as B,s as h,t as z,v as k,S as T,C as A,g as O,P as $}from"./index-BRRNp47y.js";import{E as H,M as q,S as R,a as _,D as P}from"./DemographicCard-DRL5HYYH.js";import{C as V}from"./react-apexcharts.min-CO2YcUD3.js";import{S as Q,D as W,a as G,b as J}from"./DropdownItem-B40THoVS.js";import{S as E}from"./calender-line-CMLkAvQj.js";import{S as K}from"./group-yPi5mrTw.js";const X=d=>o.createElement("svg",{stroke:"currentColor",fill:"none",strokeWidth:2,viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",...d},o.createElement("path",{d:"M19.3 14.8C20.1 16.4 21 17 21 17H3s3-2 3-9c0-3.3 2.7-6 6-6 1 0 1.9.2 2.8.7"}),o.createElement("path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0"}),o.createElement("path",{d:"M15 8h6"}),o.createElement("path",{d:"M18 5v6"}));function Y(){const d=I(),[n,b]=o.useState([]),[u,m]=o.useState(!0);o.useEffect(()=>{f()},[]);const f=async()=>{try{const a=(await L.get(`${D}/customers/all`,{withCredentials:!0})).data.customers.sort((l,x)=>new Date(x.createdAt)-new Date(l.createdAt)).slice(0,5);b(a),m(!1)}catch(t){console.error("Error fetching leads:",t),m(!1)}},v=t=>t?new Date(t).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"N/A",N=t=>({new:"New Lead",contacted:"Contacted",qualified:"Qualified",negotiation:"In Negotiation",converted:"Converted",callBackLater:"Call Back Later",notInterested:"Not Interested",lost:"Lost"})[t]||"New Lead",p=t=>t==="converted"||t==="qualified"?"success":t==="negotiation"||t==="contacted"?"info":t==="callBackLater"||t==="new"?"warning":t==="lost"||t==="notInterested"?"error":"light",y=()=>{d("/lead-management")},s=t=>{sessionStorage.setItem("openLeadId",t),d("/lead-management")};return e.jsx("div",{className:"overflow-hidden rounded-2xl border border-gray-200 bg-white px-4 pb-3 pt-4 dark:border-gray-800 dark:bg-white/[0.03] sm:px-6",children:u?e.jsx(C,{className:"py-20"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-3 mb-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white/90",children:"Recent Enquiries"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Latest 5 leads"})]}),e.jsx(F,{size:"sm",variant:"outline",onClick:y,children:"View All"})]}),e.jsx("div",{className:"max-w-full overflow-x-auto",children:e.jsxs(U,{className:"min-w-[800px]",children:[e.jsx(M,{className:"border-gray-100 dark:border-gray-800 border-y",children:e.jsxs(B,{children:[e.jsx(h,{isHeader:!0,className:"py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"Name"}),e.jsx(h,{isHeader:!0,className:"py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"Mobile"}),e.jsx(h,{isHeader:!0,className:"py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"Lead Status"}),e.jsx(h,{isHeader:!0,className:"py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"Next Follow-up"}),e.jsx(h,{isHeader:!0,className:"py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"Actions"})]})}),e.jsx(z,{className:"divide-y divide-gray-100 dark:divide-gray-800",children:n.length===0?e.jsx(B,{children:e.jsx(h,{colSpan:5,className:"py-8 text-center text-gray-500",children:"No leads found."})}):n.map(t=>{var a;return e.jsxs(B,{children:[e.jsx(h,{className:"py-3",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800 text-theme-sm dark:text-white/90",children:t.fullName}),e.jsx("p",{className:"text-gray-400 text-xs",children:((a=t.coursePreference)==null?void 0:a.join(", "))||"N/A"})]})})}),e.jsx(h,{className:"py-3 text-gray-500 text-theme-sm dark:text-gray-400",children:t.phone1}),e.jsx(h,{className:"py-3",children:e.jsx(k,{size:"sm",color:p(t.leadStatus),children:N(t.leadStatus)})}),e.jsx(h,{className:"py-3 text-gray-500 text-theme-sm dark:text-gray-400",children:v(t.followUpDate)}),e.jsx(h,{className:"py-3 text-gray-500 text-theme-sm dark:text-gray-400",children:e.jsx(F,{size:"sm",variant:"outline",className:"mr-2",endIcon:e.jsx(T,{className:"size-5"}),onClick:()=>s(t._id)})})]},t._id)})})]})})]})})}function Z(){const[d,n]=o.useState({categories:[],values:[],colors:[]}),[b,u]=o.useState(!0),[m,f]=o.useState(!1);o.useEffect(()=>{v()},[]);const v=async()=>{try{const a=(await L.get(`${D}/customers/all`,{withCredentials:!0})).data.customers,l={new:{label:"New Lead",color:"#FFA500"},contacted:{label:"Contacted",color:"#3B82F6"},qualified:{label:"Qualified",color:"#10B981"},negotiation:{label:"Negotiation",color:"#8B5CF6"},converted:{label:"Converted",color:"#059669"},callBackLater:{label:"Call Back",color:"#F59E0B"},notInterested:{label:"Not Interested",color:"#EF4444"},lost:{label:"Lost",color:"#DC2626"}},x={};a.forEach(c=>{const j=c.leadStatus||"new";x[j]=(x[j]||0)+1});const r=[],g=[],i=[];Object.entries(x).sort((c,j)=>j[1]-c[1]).forEach(([c,j])=>{l[c]&&(r.push(l[c].label),g.push(j),i.push(l[c].color))}),n({categories:r,values:g,colors:i}),u(!1)}catch(t){console.error("Error fetching status data:",t),u(!1)}},N={colors:d.colors.length>0?d.colors:["#465FFF"],chart:{fontFamily:"Outfit, sans-serif",type:"donut",height:300},labels:d.categories,legend:{show:!0,position:"bottom",horizontalAlign:"center",fontFamily:"Outfit",fontSize:"12px"},plotOptions:{pie:{donut:{size:"70%",labels:{show:!0,name:{show:!0,fontSize:"14px",fontWeight:600},value:{show:!0,fontSize:"16px",fontWeight:700,formatter:function(t){return t}},total:{show:!0,label:"Total Leads",fontSize:"14px",fontWeight:600,formatter:function(t){return t.globals.seriesTotals.reduce((a,l)=>a+l,0)}}}}}},dataLabels:{enabled:!0,formatter:function(t,a){const l=a.w.globals.seriesTotals.reduce((r,g)=>r+g,0);return(t/l*100).toFixed(1)+"%"}},tooltip:{y:{formatter:function(t,a){const l=a.w.globals.seriesTotals.reduce((r,g)=>r+g,0),x=(t/l*100).toFixed(1);return`${t} leads (${x}%)`}}}},p=d.values;function y(){f(!m)}function s(){f(!1)}return e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white px-5 pt-5 dark:border-gray-800 dark:bg-white/[0.03] sm:px-6 sm:pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white/90",children:"Lead Status Breakdown"}),e.jsx("p",{className:"mt-1 text-gray-500 text-theme-sm dark:text-gray-400",children:"Distribution of leads by status"})]}),e.jsxs("div",{className:"relative inline-block",children:[e.jsx("button",{className:"dropdown-toggle",onClick:y,children:e.jsx(Q,{className:"text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 size-6"})}),e.jsx(W,{isOpen:m,onClose:s,className:"w-40 p-2",children:e.jsx(G,{onItemClick:s,className:"flex w-full font-normal text-left text-gray-500 rounded-lg hover:bg-gray-100 hover:text-gray-700 dark:text-gray-400 dark:hover:bg-white/5 dark:hover:text-gray-300",children:"View More"})})]})]}),b?e.jsx(C,{className:"h-[300px]"}):p.length===0?e.jsx("div",{className:"text-center py-20",children:e.jsx("p",{className:"text-gray-500",children:"No lead data available"})}):e.jsx(V,{options:N,series:p,type:"donut",height:300})]})}function ee(){const d=I(),[n,b]=o.useState({today:[],upcoming:[],overdue:[]}),[u,m]=o.useState(!0);o.useEffect(()=>{f()},[]);const f=async()=>{try{const a=(await L.get(`${D}/customers/all`,{withCredentials:!0})).data.customers,l=new Date;l.setHours(0,0,0,0);const x=[],r=[],g=[];a.forEach(i=>{if(i.followUpDate){const c=new Date(i.followUpDate);c.setHours(0,0,0,0);const j=c-l,w=Math.ceil(j/(1e3*60*60*24)),S={_id:i._id,fullName:i.fullName,phone1:i.phone1,followUpDate:i.followUpDate,leadStatus:i.leadStatus,daysDiff:w};w===0?x.push(S):w>0&&w<=7?r.push(S):w<0&&g.push(S)}}),x.sort((i,c)=>new Date(i.followUpDate)-new Date(c.followUpDate)),r.sort((i,c)=>new Date(i.followUpDate)-new Date(c.followUpDate)),g.sort((i,c)=>new Date(i.followUpDate)-new Date(c.followUpDate)),b({today:x.slice(0,5),upcoming:r.slice(0,5),overdue:g.slice(0,5)}),m(!1)}catch(t){console.error("Error fetching follow-ups:",t),m(!1)}},v=t=>t?new Date(t).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"N/A",N=t=>t==="converted"||t==="qualified"?"success":t==="negotiation"||t==="contacted"?"info":t==="callBackLater"||t==="new"?"warning":t==="lost"||t==="notInterested"?"error":"light",p=t=>({new:"New Lead",contacted:"Contacted",qualified:"Qualified",negotiation:"In Negotiation",converted:"Converted",callBackLater:"Call Back Later",notInterested:"Not Interested",lost:"Lost"})[t]||t,y=t=>{sessionStorage.setItem("openLeadId",t),d("/lead-management")},s=(t,a,l,x)=>a.length===0?null:e.jsxs("div",{className:"mb-6 last:mb-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[x,e.jsx("h4",{className:"font-semibold text-gray-800 dark:text-white/90",children:t}),e.jsx(k,{color:l,size:"sm",children:a.length})]}),e.jsx("div",{className:"space-y-2",children:a.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer transition-colors",onClick:()=>y(r._id),children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm text-gray-800 dark:text-white/90",children:r.fullName}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[r.phone1," â€¢ ",v(r.followUpDate),r.daysDiff!==0&&e.jsx("span",{className:`ml-2 ${r.daysDiff<0?"text-red-500":"text-blue-500"}`,children:r.daysDiff<0?`${Math.abs(r.daysDiff)} days overdue`:`in ${r.daysDiff} days`})]})]}),e.jsx(k,{size:"sm",color:N(r.leadStatus),children:p(r.leadStatus)})]},r._id))})]});return e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white px-5 pt-5 dark:border-gray-800 dark:bg-white/[0.03] sm:px-6 sm:pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white/90",children:"Follow-ups Due"}),e.jsx("p",{className:"mt-1 text-gray-500 text-theme-sm dark:text-gray-400",children:"Leads requiring attention"})]}),e.jsx(F,{size:"sm",variant:"outline",onClick:()=>d("/lead-management"),children:"View All"})]}),u?e.jsx(C,{className:"py-20"}):e.jsxs("div",{className:"max-h-[500px] overflow-y-auto custom-scrollbar",children:[n.overdue.length>0&&s("Overdue",n.overdue,"error",e.jsx(X,{className:"size-5 text-red-500"})),n.today.length>0&&s("Today",n.today,"warning",e.jsx(E,{className:"size-5 text-orange-500"})),n.upcoming.length>0&&s("Upcoming (7 days)",n.upcoming,"info",e.jsx(E,{className:"size-5 text-blue-500"})),n.today.length===0&&n.upcoming.length===0&&n.overdue.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No follow-ups scheduled"})})]})]})}function te(){const[d,n]=o.useState({topByLeads:[],topByConversions:[]}),[b,u]=o.useState(!0),[m,f]=o.useState("leads");o.useEffect(()=>{v()},[]);const v=async()=>{try{const s=await L.get(`${D}/customers/leaderboard`,{withCredentials:!0});n({topByLeads:s.data.topByLeads||[],topByConversions:s.data.topByConversions||[]}),u(!1)}catch(s){console.error("Error fetching leaderboard:",s),u(!1)}},N=s=>s===0?"success":s===1?"info":s===2?"warning":"light",p=s=>s===0?"ðŸ¥‡":s===1?"ðŸ¥ˆ":s===2?"ðŸ¥‰":`${s+1}`,y=m==="leads"?d.topByLeads:d.topByConversions;return e.jsx(A,{title:"Leaderboard",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:()=>f("leads"),className:`px-4 py-2 text-sm font-medium transition-colors ${m==="leads"?"text-brand-600 border-b-2 border-brand-600 dark:text-brand-400 dark:border-brand-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"size-4"}),"Most Leads"]})}),e.jsx("button",{onClick:()=>f("conversions"),className:`px-4 py-2 text-sm font-medium transition-colors ${m==="conversions"?"text-brand-600 border-b-2 border-brand-600 dark:text-brand-400 dark:border-brand-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"size-4"}),"Most Conversions"]})})]}),b?e.jsx(C,{className:"py-20"}):y.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No data available for this month"})}):e.jsx("div",{className:"space-y-3",children:y.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 flex items-center justify-center",children:t<3?e.jsx("span",{className:"text-lg",children:p(t)}):e.jsx(k,{color:N(t),className:"text-xs",children:t+1})}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:O(s.avatar),alt:s.fullName,className:"w-10 h-10 rounded-full object-cover",onError:a=>{a.target.src="/images/user/user-01.jpg"}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-800 dark:text-white/90 truncate",children:s.fullName}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:s.email})]})]}),e.jsx("div",{className:"flex items-center gap-4 ml-4",children:m==="leads"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-800 dark:text-white/90",children:s.totalLeads}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Leads"})]}),s.conversions>0&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold text-success-600 dark:text-success-400",children:s.conversions}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Converted"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold text-success-600 dark:text-success-400",children:s.conversions}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Conversions"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-800 dark:text-white/90",children:[s.conversionRate,"%"]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Rate"})]})]})})]},s.userId))})]})})}function ie(){return e.jsxs(e.Fragment,{children:[e.jsx($,{title:"Leads Dashboard | CRM Dashboard Overview",description:"Comprehensive dashboard for leads, admissions, revenue, and student management"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white/90",children:"Leads Dashboard"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Overview of your leads, admissions, revenue, and key metrics"})]}),e.jsx(H,{}),e.jsxs("div",{className:"grid grid-cols-12 gap-4 md:gap-6",children:[e.jsxs("div",{className:"col-span-12 space-y-6 xl:col-span-8",children:[e.jsx(q,{}),e.jsx(R,{}),e.jsx(ee,{})]}),e.jsxs("div",{className:"col-span-12 space-y-6 xl:col-span-4",children:[e.jsx(_,{}),e.jsx(te,{}),e.jsx(Z,{}),e.jsx(P,{})]}),e.jsx("div",{className:"col-span-12",children:e.jsx(Y,{})})]})]})]})}export{ie as default};
