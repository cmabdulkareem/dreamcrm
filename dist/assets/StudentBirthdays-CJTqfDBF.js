import{r,w as E,b as P,c as x,j as e,P as D,m as $,M as B}from"./index-BNEGGE57.js";import{F,i as L,a as O,b as V}from"./index-c4765rev.js";import{S as G}from"./StudentProfileModal-D1ddp5oS.js";const Y=()=>{const[l,h]=r.useState([]),[m,d]=r.useState(!0),[g,p]=r.useState([]),{isOpen:f,openModal:b,closeModal:o}=E(),[t,y]=r.useState(null),[j,i]=r.useState(!1);r.useEffect(()=>{v()},[]);const v=async()=>{try{d(!0);const n=(await P.get(`${x}/students/all`,{withCredentials:!0})).data.students||[];h(n),w(n)}catch(s){console.error("Error fetching students:",s)}finally{d(!1)}},w=s=>{const n=new Date().getFullYear(),S=s.filter(a=>a.dob).flatMap(a=>{const c=new Date(a.dob);return[-1,0,1].map(C=>{const u=n+C,M=new Date(u,c.getMonth(),c.getDate());return{id:`${a._id}-${u}`,title:`ðŸ° ${a.fullName}`,start:M.toISOString().split("T")[0],allDay:!0,extendedProps:{student:a,isBirthday:!0},backgroundColor:"#f472b6",borderColor:"#db2777"}})});p(S)},N=s=>{y(s.event.extendedProps.student),b()},k=()=>{i(!0),o()};return e.jsxs(e.Fragment,{children:[e.jsx(D,{title:"Student Birthdays | DreamCRM",description:"View student birthdays on a calendar"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-6 dark:border-gray-800 dark:bg-white/[0.03]",children:[e.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Student Birthday Calendar"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Celebrate and engage with students on their special day"})]})}),m?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx($,{})}):e.jsx("div",{className:"custom-calendar birthday-calendar",children:e.jsx(F,{plugins:[L,O,V],initialView:"dayGridMonth",headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek"},events:g,eventClick:N,eventContent:I,height:"auto"})})]}),e.jsx(B,{isOpen:f,onClose:o,className:"max-w-[400px] p-6 text-center",children:t&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("img",{src:t.photo?`${x.replace("/api","")}${t.photo}`:"/images/user/user-01.jpg",alt:t.fullName,className:"w-24 h-24 rounded-full object-cover border-4 border-pink-100 dark:border-pink-900/30",onError:s=>{s.target.src="/images/user/user-01.jpg"}}),e.jsx("div",{className:"absolute -bottom-1 -right-1 bg-white dark:bg-gray-900 p-1.5 rounded-full shadow-sm",children:e.jsx("span",{className:"text-xl",children:"ðŸ°"})})]}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-1",children:t.fullName}),e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Birthday on ",new Date(t.dob).toLocaleDateString("en-GB",{day:"numeric",month:"long"})]}),e.jsxs("div",{className:"w-full space-y-2",children:[e.jsxs("a",{href:`tel:${t.phone1}`,className:"flex items-center justify-center gap-2 w-full py-2.5 rounded-lg bg-success-500 text-white font-medium hover:bg-success-600 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),"Call Student"]}),e.jsx("button",{onClick:k,className:"flex items-center justify-center gap-2 w-full py-2.5 rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"View Full Profile"})]})]})}),t&&e.jsx(G,{isOpen:j,onClose:()=>i(!1),student:t})]})]})},I=l=>e.jsx("div",{className:"flex items-center gap-1 p-1 overflow-hidden",children:e.jsx("div",{className:"text-xs truncate font-medium text-white",children:l.event.title})});export{Y as default};
