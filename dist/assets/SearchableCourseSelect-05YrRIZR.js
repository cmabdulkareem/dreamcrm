import{r as t,j as s,I as E,m as I,b as R,c as $}from"./index-BNEGGE57.js";import{S as F}from"./chevron-down-BH7m1aFk.js";const O=t.forwardRef(({value:d,onChange:l,placeholder:v="Search and select a course...",error:y,disabled:n=!1},A)=>{const[c,C]=t.useState([]),[x,f]=t.useState([]),[h,i]=t.useState(!1),[a,u]=t.useState(""),[j,g]=t.useState(!1),m=t.useRef(null),p=t.useRef(null);t.useEffect(()=>{(async()=>{try{g(!0);const o=(await R.get(`${$}/courses/all`,{withCredentials:!0})).data.courses.filter(L=>L.isActive);C(o),f(o)}catch(r){console.error("Error fetching courses:",r)}finally{g(!1)}})()},[]),t.useEffect(()=>{if(!a)f(c.filter(e=>e.isActive));else{const e=a.toLowerCase(),r=c.filter(o=>o.isActive&&(o.courseName.toLowerCase().includes(e)||o.courseCode.toLowerCase().includes(e)));f(r)}},[a,c]),t.useEffect(()=>{const e=r=>{m.current&&!m.current.contains(r.target)&&i(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);const k=t.useCallback(e=>{l(e._id),i(!1),u(`${e.courseCode} - ${e.courseName}`)},[l]),N=t.useCallback(e=>{const r=e.target.value;u(r),r&&i(!0)},[]),w=t.useCallback(()=>{n||i(!0)},[n]),b=t.useCallback(()=>{var e;u(""),l(""),(e=p.current)==null||e.focus()},[l]);t.useEffect(()=>{if(d&&!a){const e=c.find(r=>r._id===d);e&&u(`${e.courseCode} - ${e.courseName}`)}},[d,c,a]);const S=()=>s.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})});return s.jsxs("div",{className:"relative",ref:m,children:[s.jsxs("div",{className:"relative",children:[s.jsx(E,{ref:p,type:"text",value:a,onChange:N,onFocus:w,placeholder:v,error:y,disabled:n,className:"pr-20"}),s.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:j?s.jsx(I,{className:"",size:"h-4 w-4"}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"flex items-center pr-2 border-r border-gray-300 dark:border-gray-700 mr-2",children:s.jsx(S,{})}),s.jsx(F,{className:`h-4 w-4 text-gray-400 transition-transform ${h?"rotate-180":""}`})]})}),a&&!n&&s.jsx("button",{type:"button",className:"absolute inset-y-0 right-12 flex items-center pr-2 text-gray-400 hover:text-gray-600",onClick:b,children:s.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),h&&!n&&s.jsx("div",{className:"absolute z-10 mt-1 w-full rounded-md bg-white shadow-lg dark:bg-gray-800",children:s.jsx("div",{className:"max-h-60 overflow-auto py-1",children:x.length===0?s.jsx("div",{className:"px-4 py-2 text-gray-500 dark:text-gray-400",children:a?"No courses found":"No courses available"}):x.map(e=>s.jsxs("button",{type:"button",className:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700",onClick:()=>k(e),children:[s.jsx("div",{className:"font-medium",children:e.courseName}),s.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.courseCode," • ",e.duration," months • ₹",e.normalFee]})]},e._id))})})]})});export{O as S};
