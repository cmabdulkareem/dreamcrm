import{r as o,a as U,b as L,c as D,j as e,m as B,B as E,T as M,o as z,p as F,q as u,s as T,t as S,S as A,C as O,g as $,P as H}from"./index-BNEGGE57.js";import{E as R,M as q,S as P,a as _,D as V}from"./DemographicCard-C0oC-zcU.js";import{C as Q}from"./react-apexcharts.min-D6ltuXqm.js";import{S as W,D as G,a as J}from"./DropdownItem-Dt-e3e_M.js";import{S as I}from"./calender-line-DQbsZUHO.js";import{S as K}from"./group-C53OQBfh.js";import{S as X}from"./shooting-star-B8F1DdHT.js";const Y=l=>o.createElement("svg",{stroke:"currentColor",fill:"none",strokeWidth:2,viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",...l},o.createElement("path",{d:"M19.3 14.8C20.1 16.4 21 17 21 17H3s3-2 3-9c0-3.3 2.7-6 6-6 1 0 1.9.2 2.8.7"}),o.createElement("path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0"}),o.createElement("path",{d:"M15 8h6"}),o.createElement("path",{d:"M18 5v6"}));function Z(){const l=U(),[n,b]=o.useState([]),[f,x]=o.useState(!0);o.useEffect(()=>{p()},[]);const p=async()=>{try{const a=(await L.get(`${D}/customers/all`,{withCredentials:!0})).data.customers.sort((d,h)=>new Date(h.createdAt)-new Date(d.createdAt)).slice(0,5);b(a),x(!1)}catch(t){console.error("Error fetching leads:",t),x(!1)}},N=t=>t?new Date(t).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"N/A",w=t=>t.isAdmissionTaken?"Converted":{new:"New Lead",contacted:"Contacted",qualified:"Qualified",negotiation:"In Negotiation",converted:"Converted",callBackLater:"Call Back Later",notInterested:"Not Interested",lost:"Lost"}[t.leadStatus]||"New Lead",y=t=>{const a=t.isAdmissionTaken?"converted":t.leadStatus;return a==="converted"||a==="qualified"?"success":a==="negotiation"||a==="contacted"?"info":a==="callBackLater"||a==="new"?"warning":a==="lost"||a==="notInterested"?"error":"light"},j=()=>{l("/lead-management")},s=t=>{sessionStorage.setItem("openLeadId",t),l("/lead-management")};return e.jsx("div",{className:"overflow-hidden rounded-2xl border border-gray-200 bg-white px-4 pb-3 pt-4 dark:border-gray-800 dark:bg-white/[0.03] sm:px-6",children:f?e.jsx(B,{className:"py-20"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-3 mb-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white/90",children:"Recent Enquiries"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Latest 5 leads"})]}),e.jsx(E,{size:"sm",variant:"outline",onClick:j,children:"View All"})]}),e.jsx("div",{className:"max-w-full overflow-x-auto",children:e.jsxs(M,{className:"min-w-[800px]",children:[e.jsx(z,{className:"border-gray-100 dark:border-gray-800 border-y",children:e.jsxs(F,{children:[e.jsx(u,{isHeader:!0,className:"py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"Name"}),e.jsx(u,{isHeader:!0,className:"py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"Mobile"}),e.jsx(u,{isHeader:!0,className:"py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"Lead Status"}),e.jsx(u,{isHeader:!0,className:"py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"Next Follow-up"}),e.jsx(u,{isHeader:!0,className:"py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"Actions"})]})}),e.jsx(T,{className:"divide-y divide-gray-100 dark:divide-gray-800",children:n.length===0?e.jsx(F,{children:e.jsx(u,{colSpan:5,className:"py-8 text-center text-gray-500",children:"No leads found."})}):n.map(t=>{var a;return e.jsxs(F,{children:[e.jsx(u,{className:"py-3",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800 text-theme-sm dark:text-white/90",children:t.fullName}),e.jsx("p",{className:"text-gray-400 text-xs",children:((a=t.coursePreference)==null?void 0:a.join(", "))||"N/A"})]})})}),e.jsx(u,{className:"py-3 text-gray-500 text-theme-sm dark:text-gray-400",children:t.phone1}),e.jsx(u,{className:"py-3",children:e.jsx(S,{size:"sm",color:y(t),children:w(t)})}),e.jsx(u,{className:"py-3 text-gray-500 text-theme-sm dark:text-gray-400",children:N(t.followUpDate)}),e.jsx(u,{className:"py-3 text-gray-500 text-theme-sm dark:text-gray-400",children:e.jsx(E,{size:"sm",variant:"outline",className:"mr-2",endIcon:e.jsx(A,{className:"size-5"}),onClick:()=>s(t._id)})})]},t._id)})})]})})]})})}function ee(){const[l,n]=o.useState({categories:[],values:[],colors:[]}),[b,f]=o.useState(!0),[x,p]=o.useState(!1);o.useEffect(()=>{N()},[]);const N=async()=>{try{const[t,a]=await Promise.all([L.get(`${D}/customers/all`,{withCredentials:!0}),L.get(`${D}/students/all`,{withCredentials:!0})]),d=t.data.customers,h=a.data.students||[],r={new:{label:"New Lead",color:"#FFA500"},contacted:{label:"Contacted",color:"#3B82F6"},qualified:{label:"Qualified",color:"#10B981"},negotiation:{label:"Negotiation",color:"#8B5CF6"},converted:{label:"Converted",color:"#059669"},callBackLater:{label:"Call Back",color:"#F59E0B"},notInterested:{label:"Not Interested",color:"#EF4444"},lost:{label:"Lost",color:"#DC2626"}},m={};d.forEach(c=>{const k=c.isAdmissionTaken?"converted":c.leadStatus||"new";m[k]=(m[k]||0)+1});const i=h.filter(c=>!c.leadId).length;m.converted=(m.converted||0)+i;const g=[],C=[],v=[];Object.entries(m).sort((c,k)=>k[1]-c[1]).forEach(([c,k])=>{r[c]&&(g.push(r[c].label),C.push(k),v.push(r[c].color))}),n({categories:g,values:C,colors:v}),f(!1)}catch(t){console.error("Error fetching status data:",t),f(!1)}},w={colors:l.colors.length>0?l.colors:["#465FFF"],chart:{fontFamily:"Outfit, sans-serif",type:"donut",height:300},labels:l.categories,legend:{show:!0,position:"bottom",horizontalAlign:"center",fontFamily:"Outfit",fontSize:"12px"},plotOptions:{pie:{donut:{size:"70%",labels:{show:!0,name:{show:!0,fontSize:"14px",fontWeight:600},value:{show:!0,fontSize:"16px",fontWeight:700,formatter:function(t){return t}},total:{show:!0,label:"Total Leads",fontSize:"14px",fontWeight:600,formatter:function(t){return t.globals.seriesTotals.reduce((a,d)=>a+d,0)}}}}}},dataLabels:{enabled:!0,formatter:function(t,a){const d=a.w.globals.seriesTotals.reduce((r,m)=>r+m,0);return(t/d*100).toFixed(1)+"%"}},tooltip:{y:{formatter:function(t,a){const d=a.w.globals.seriesTotals.reduce((r,m)=>r+m,0),h=(t/d*100).toFixed(1);return`${t} leads (${h}%)`}}}},y=l.values;function j(){p(!x)}function s(){p(!1)}return e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white px-5 pt-5 dark:border-gray-800 dark:bg-white/[0.03] sm:px-6 sm:pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white/90",children:"Lead Status Breakdown"}),e.jsx("p",{className:"mt-1 text-gray-500 text-theme-sm dark:text-gray-400",children:"Distribution of leads by status"})]}),e.jsxs("div",{className:"relative inline-block",children:[e.jsx("button",{className:"dropdown-toggle",onClick:j,children:e.jsx(W,{className:"text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 size-6"})}),e.jsx(G,{isOpen:x,onClose:s,className:"w-40 p-2",children:e.jsx(J,{onItemClick:s,className:"flex w-full font-normal text-left text-gray-500 rounded-lg hover:bg-gray-100 hover:text-gray-700 dark:text-gray-400 dark:hover:bg-white/5 dark:hover:text-gray-300",children:"View More"})})]})]}),b?e.jsx(B,{className:"h-[300px]"}):y.length===0?e.jsx("div",{className:"text-center py-20",children:e.jsx("p",{className:"text-gray-500",children:"No lead data available"})}):e.jsx(Q,{options:w,series:y,type:"donut",height:300})]})}function te(){const l=U(),[n,b]=o.useState({today:[],upcoming:[],overdue:[]}),[f,x]=o.useState(!0);o.useEffect(()=>{p()},[]);const p=async()=>{try{const a=(await L.get(`${D}/customers/all`,{withCredentials:!0})).data.customers,d=new Date;d.setHours(0,0,0,0);const h=[],r=[],m=[];a.forEach(i=>{if(i.followUpDate){const g=new Date(i.followUpDate);g.setHours(0,0,0,0);const C=g-d,v=Math.ceil(C/(1e3*60*60*24)),c={_id:i._id,fullName:i.fullName,phone1:i.phone1,followUpDate:i.followUpDate,leadStatus:i.leadStatus,daysDiff:v};v===0?h.push(c):v>0&&v<=7?r.push(c):v<0&&m.push(c)}}),h.sort((i,g)=>new Date(i.followUpDate)-new Date(g.followUpDate)),r.sort((i,g)=>new Date(i.followUpDate)-new Date(g.followUpDate)),m.sort((i,g)=>new Date(i.followUpDate)-new Date(g.followUpDate)),b({today:h.slice(0,5),upcoming:r.slice(0,5),overdue:m.slice(0,5)}),x(!1)}catch(t){console.error("Error fetching follow-ups:",t),x(!1)}},N=t=>t?new Date(t).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"N/A",w=t=>t==="converted"||t==="qualified"?"success":t==="negotiation"||t==="contacted"?"info":t==="callBackLater"||t==="new"?"warning":t==="lost"||t==="notInterested"?"error":"light",y=t=>({new:"New Lead",contacted:"Contacted",qualified:"Qualified",negotiation:"In Negotiation",converted:"Converted",callBackLater:"Call Back Later",notInterested:"Not Interested",lost:"Lost"})[t]||t,j=t=>{sessionStorage.setItem("openLeadId",t),l("/lead-management")},s=(t,a,d,h)=>a.length===0?null:e.jsxs("div",{className:"mb-6 last:mb-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[h,e.jsx("h4",{className:"font-semibold text-gray-800 dark:text-white/90",children:t}),e.jsx(S,{color:d,size:"sm",children:a.length})]}),e.jsx("div",{className:"space-y-2",children:a.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer transition-colors",onClick:()=>j(r._id),children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm text-gray-800 dark:text-white/90",children:r.fullName}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[r.phone1," â€¢ ",N(r.followUpDate),r.daysDiff!==0&&e.jsx("span",{className:`ml-2 ${r.daysDiff<0?"text-red-500":"text-blue-500"}`,children:r.daysDiff<0?`${Math.abs(r.daysDiff)} days overdue`:`in ${r.daysDiff} days`})]})]}),e.jsx(S,{size:"sm",color:w(r.leadStatus),children:y(r.leadStatus)})]},r._id))})]});return e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white px-5 pt-5 dark:border-gray-800 dark:bg-white/[0.03] sm:px-6 sm:pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white/90",children:"Follow-ups Due"}),e.jsx("p",{className:"mt-1 text-gray-500 text-theme-sm dark:text-gray-400",children:"Leads requiring attention"})]}),e.jsx(E,{size:"sm",variant:"outline",onClick:()=>l("/lead-management"),children:"View All"})]}),f?e.jsx(B,{className:"py-20"}):e.jsxs("div",{className:"max-h-[500px] overflow-y-auto custom-scrollbar",children:[n.overdue.length>0&&s("Overdue",n.overdue,"error",e.jsx(Y,{className:"size-5 text-red-500"})),n.today.length>0&&s("Today",n.today,"warning",e.jsx(I,{className:"size-5 text-orange-500"})),n.upcoming.length>0&&s("Upcoming (7 days)",n.upcoming,"info",e.jsx(I,{className:"size-5 text-blue-500"})),n.today.length===0&&n.upcoming.length===0&&n.overdue.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No follow-ups scheduled"})})]})]})}function se(){const[l,n]=o.useState({topByLeads:[],topByConversions:[]}),[b,f]=o.useState(!0),[x,p]=o.useState("leads");o.useEffect(()=>{N()},[]);const N=async()=>{try{const s=await L.get(`${D}/customers/leaderboard`,{withCredentials:!0});n({topByLeads:s.data.topByLeads||[],topByConversions:s.data.topByConversions||[]}),f(!1)}catch(s){console.error("Error fetching leaderboard:",s),f(!1)}},w=s=>s===0?"success":s===1?"info":s===2?"warning":"light",y=s=>s===0?"ðŸ¥‡":s===1?"ðŸ¥ˆ":s===2?"ðŸ¥‰":`${s+1}`,j=x==="leads"?l.topByLeads:l.topByConversions;return e.jsx(O,{title:"Leaderboard",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:()=>p("leads"),className:`px-4 py-2 text-sm font-medium transition-colors ${x==="leads"?"text-brand-600 border-b-2 border-brand-600 dark:text-brand-400 dark:border-brand-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"size-4"}),"Most Leads"]})}),e.jsx("button",{onClick:()=>p("conversions"),className:`px-4 py-2 text-sm font-medium transition-colors ${x==="conversions"?"text-brand-600 border-b-2 border-brand-600 dark:text-brand-400 dark:border-brand-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"size-4"}),"Most Conversions"]})})]}),b?e.jsx(B,{className:"py-20"}):j.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No data available for this month"})}):e.jsx("div",{className:"space-y-3",children:j.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 flex items-center justify-center",children:t<3?e.jsx("span",{className:"text-lg",children:y(t)}):e.jsx(S,{color:w(t),className:"text-xs",children:t+1})}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:$(s.avatar),alt:s.fullName,className:"w-10 h-10 rounded-full object-cover",onError:a=>{a.target.src="/images/user/user-01.jpg"}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-800 dark:text-white/90 truncate",children:s.fullName}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:s.email})]})]}),e.jsx("div",{className:"flex items-center gap-4 ml-4",children:x==="leads"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-800 dark:text-white/90",children:s.totalLeads}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Leads"})]}),s.conversions>0&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold text-success-600 dark:text-success-400",children:s.conversions}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Converted"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold text-success-600 dark:text-success-400",children:s.conversions}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Conversions"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-800 dark:text-white/90",children:[s.conversionRate,"%"]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Rate"})]})]})})]},s.userId))})]})})}function ce(){return e.jsxs(e.Fragment,{children:[e.jsx(H,{title:"Leads Dashboard | CRM Dashboard Overview",description:"Comprehensive dashboard for leads, admissions, revenue, and student management"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white/90",children:"Leads Dashboard"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Overview of your leads, admissions, revenue, and key metrics"})]}),e.jsx(R,{}),e.jsxs("div",{className:"grid grid-cols-12 gap-4 md:gap-6",children:[e.jsxs("div",{className:"col-span-12 space-y-6 xl:col-span-8",children:[e.jsx(q,{}),e.jsx(P,{}),e.jsx(te,{})]}),e.jsxs("div",{className:"col-span-12 space-y-6 xl:col-span-4",children:[e.jsx(_,{}),e.jsx(se,{}),e.jsx(ee,{}),e.jsx(V,{})]}),e.jsx("div",{className:"col-span-12",children:e.jsx(Z,{})})]})]})]})}export{ce as default};
