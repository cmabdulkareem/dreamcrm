import{r,A as os,x as J,w as j,h as w,c as y,d as N,y as l,j as e,P as cs,G as xs,B as o,C as ms,z as i,I as h,n as us,T as gs,p as hs,q as Le,s as m,t as ps,M as X,W as Te,X as Ue,a5 as bs,o as fs,a7 as js,a8 as ze}from"./index-BRRNp47y.js";import{P as ys}from"./papaparse.min-BTrlYlEl.js";import{S as Ns}from"./file-Bn9R9aj5.js";function Ms(){const{user:x,selectedBrand:ue}=r.useContext(os),[P,A]=r.useState([]),[Oe,ge]=r.useState(!0),[Q,he]=r.useState(""),{isOpen:Re,openModal:pe,closeModal:Y}=J(),{isOpen:$e,openModal:Be,closeModal:Z}=J(),{isOpen:Ve,openModal:He,closeModal:ee}=J(),{isOpen:Ke,openModal:We,closeModal:se}=J(),[C,D]=r.useState(""),[S,F]=r.useState(""),[I,_]=r.useState(""),[L,T]=r.useState(""),[ae,U]=r.useState(""),[te,z]=r.useState(""),[O,R]=r.useState(""),[E,qe]=r.useState([]),[$,re]=r.useState(null),[B,p]=r.useState(!1),[u,v]=r.useState([]),[le,Ge]=r.useState(null),[ne,be]=r.useState(""),[de,fe]=r.useState(""),[ie,je]=r.useState(""),[g,b]=r.useState(1),[k,Je]=r.useState({totalItems:0,totalPages:1,currentPage:1}),[V,ye]=r.useState(""),[H,Ne]=r.useState(""),[K,ve]=r.useState(""),[W,ke]=r.useState(""),[we,vs]=r.useState("createdAt"),[Ce,ks]=r.useState("desc"),[oe,Xe]=r.useState("");r.useEffect(()=>{const s=setTimeout(()=>{Xe(Q),b(1)},500);return()=>clearTimeout(s)},[Q]);const Qe=j(x);r.useEffect(()=>{ce(),(j(x)||w(x))&&Ye()},[x,g,oe,V,H,K,W,we,Ce]);const Ye=async()=>{try{const s=new URLSearchParams;ue&&s.append("brandId",ue._id);const t=await y.get(`${N}/users/dropdown?${s.toString()}`,{withCredentials:!0});qe(t.data.users||[])}catch(s){console.error("Error fetching users:",s)}},ce=async()=>{try{ge(!0);const s=new URLSearchParams({page:g,limit:50,sortBy:we,sortOrder:Ce});oe&&s.append("search",oe),V&&s.append("startDate",V),H&&s.append("endDate",H),K&&s.append("creator",K),W&&s.append("assignedTo",W);const t=await y.get(`${N}/call-lists?${s.toString()}`,{withCredentials:!0});A(t.data.callLists),Je(t.data.pagination)}catch(s){console.error("Error fetching call lists:",s),l.error("Failed to load call lists.")}finally{ge(!1),v([])}},xe=()=>{D(""),F(""),_(""),T(""),U(""),z(""),R(""),re(null)},Ze=async()=>{var s,t;if(!C&&!S&&!I){l.error("Please fill at least one field (Name, Phone, or Social Media ID).");return}try{p(!0);const a=await y.post(`${N}/call-lists`,{name:C,phoneNumber:S,socialMediaId:I,remarks:L,assignedTo:O},{withCredentials:!0});l.success("Call list entry added successfully!"),A([a.data.callList,...P]),Y(),xe()}catch(a){console.error("Error adding call list:",a),l.error(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to add entry.")}finally{p(!1)}},es=s=>{var t;re(s),D(s.name||""),F(s.phoneNumber||""),_(s.socialMediaId||""),T(s.remarks||""),U(s.source||""),z(s.purpose||""),R(((t=s.assignedTo)==null?void 0:t._id)||""),Be()},ss=async()=>{var s,t;if(!C&&!S&&!I){l.error("Please fill at least one field (Name, Phone, or Social Media ID).");return}try{p(!0);const a=await y.put(`${N}/call-lists/${$._id}`,{name:C,phoneNumber:S,socialMediaId:I,remarks:L,source:ae,purpose:te,assignedTo:O||null},{withCredentials:!0});l.success("Call list entry updated successfully!"),A(P.map(n=>n._id===$._id?a.data.callList:n)),Z(),xe()}catch(a){console.error("Error updating call list:",a),l.error(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to update entry.")}finally{p(!1)}},as=s=>{re(s),He()},ts=async()=>{var s,t;try{await y.delete(`${N}/call-lists/${$._id}`,{withCredentials:!0}),l.success("Call list entry deleted successfully!"),A(P.filter(a=>a._id!==$._id)),ee(),xe()}catch(a){console.error("Error deleting call list:",a),l.error(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to delete entry.")}},rs=async(s,t)=>{var a,n;try{await y.patch(`${N}/call-lists/${s}/status`,{status:t},{withCredentials:!0}),l.success("Status updated successfully!"),A(P.map(d=>d._id===s?{...d,status:t}:d))}catch(d){console.error("Error updating status:",d),l.error(((n=(a=d.response)==null?void 0:a.data)==null?void 0:n.message)||"Failed to update status.")}},ls=()=>{u.length===f.length&&f.length>0?v([]):v(f.map(s=>s._id))},Se=(s,t,a)=>{if(a!=null&&a.shiftKey&&le!==null&&t!==void 0){const n=Math.min(le,t),d=Math.max(le,t),M=f.slice(n,d+1).map(G=>G._id),q=[...new Set([...u,...M])];v(q)}else u.includes(s)?v(u.filter(n=>n!==s)):v([...u,s]);t!==void 0&&Ge(t)},ns=async()=>{var s,t;if(u.length===0){l.error("Please select entries to update.");return}if(!ne&&!de&&!ie){l.error("Please select a user, or enter source/purpose to update.");return}try{p(!0);const a=await y.post(`${N}/call-lists/bulk-assign`,{ids:u,assignedTo:ne,source:de,purpose:ie},{withCredentials:!0});l.success(a.data.message||"Bulk update successful!"),ce(),be(""),fe(""),je("")}catch(a){console.error("Error in bulk update:",a),l.error(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to perform bulk update.")}finally{p(!1)}},f=P,Ie=s=>s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",Me=s=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{size:"sm",variant:"outline",onClick:()=>es(s),children:"Edit"}),Qe&&e.jsx(o,{size:"sm",variant:"outline",className:"text-red-500",endIcon:e.jsx(js,{className:"size-4"}),onClick:()=>as(s)})]}),Pe=s=>{var t;return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold w-fit capitalize ${((t=ze.find(a=>a.value===s.status))==null?void 0:t.color)||"bg-gray-100 text-gray-700"}`,children:s.status||"pending"}),e.jsx("select",{className:"text-xs bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg px-2 py-1.5 outline-none focus:border-brand-500 focus:ring-1 focus:ring-brand-200 cursor-pointer",value:s.status||"pending",onChange:a=>rs(s._id,a.target.value),children:ze.map(a=>e.jsxs("option",{value:a.value,children:["Mark as ",a.label]},a.value))})]})};return e.jsxs("div",{className:"p-4 md:p-6",children:[e.jsx(cs,{title:"Cold Call list | DreamCRM",description:"Manage customer contact information"}),e.jsx(xs,{pageTitle:"Cold Call list"}),u.length>0&&e.jsxs("div",{className:"mb-6 p-4 bg-brand-50/50 dark:bg-brand-500/5 border border-brand-100 dark:border-brand-500/20 rounded-xl flex flex-col md:flex-row items-center justify-between gap-4 animate-in fade-in slide-in-from-top-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center size-8 bg-brand-500 text-white text-sm font-bold rounded-lg shadow-lg shadow-brand-500/20",children:u.length}),e.jsxs("div",{children:[e.jsxs("span",{className:"block text-sm font-semibold text-gray-800 dark:text-white",children:[u.length," Entries Selected"]}),e.jsx("button",{onClick:()=>v([]),className:"text-xs text-brand-500 hover:text-brand-600 font-medium transition-colors",children:"Clear Selection"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-end gap-3 w-full md:w-auto",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-gray-500 font-medium mb-1 block uppercase tracking-wider",children:"Source"}),e.jsx("input",{type:"text",value:de,onChange:s=>fe(s.target.value),placeholder:"e.g. LinkedIn",className:"w-full sm:w-[150px] rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 focus:border-brand-500 focus:ring focus:ring-brand-200 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 outline-none shadow-sm transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-gray-500 font-medium mb-1 block uppercase tracking-wider",children:"Purpose"}),e.jsx("input",{type:"text",value:ie,onChange:s=>je(s.target.value),placeholder:"e.g. Sales",className:"w-full sm:w-[150px] rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 focus:border-brand-500 focus:ring focus:ring-brand-200 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 outline-none shadow-sm transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-gray-500 font-medium mb-1 block uppercase tracking-wider",children:"Assign To"}),e.jsx("div",{className:"relative sm:min-w-[200px]",children:e.jsxs("select",{value:ne,onChange:s=>be(s.target.value),className:"w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 focus:border-brand-500 focus:ring focus:ring-brand-200 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 outline-none shadow-sm transition-all",children:[e.jsx("option",{value:"",children:"Select User (No Change)"}),e.jsx("option",{value:"unassign",children:"Unassign (None)"}),E.map(s=>e.jsx("option",{value:s._id,children:s.fullName},s._id))]})})]}),e.jsx(o,{variant:"primary",loading:B,onClick:ns,className:"whitespace-nowrap shadow-lg shadow-brand-500/20 h-[38px] mb-[1px]",children:"Update Selected"})]})]}),e.jsx("div",{className:"mb-8 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:e.jsxs("div",{className:"flex gap-3 w-full sm:w-auto",children:[e.jsx(o,{variant:"outline",onClick:We,className:"w-full sm:w-auto",startIcon:e.jsx(Ns,{className:"size-4"}),children:"Import"}),e.jsx(o,{variant:"primary",onClick:pe,className:"w-full sm:w-auto",children:"Add New Entry"})]})}),e.jsxs(ms,{children:[e.jsxs("div",{className:"mb-8 space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(i,{className:"text-xs",children:"Search"}),e.jsx(h,{type:"text",placeholder:"Search by name, phone, etc...",value:Q,onChange:s=>{he(s.target.value),b(1)},className:"h-10"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"w-44",children:[e.jsx(i,{className:"text-xs",children:"Start Date"}),e.jsx(h,{type:"date",value:V,onChange:s=>{ye(s.target.value),b(1)},className:"h-10"})]}),e.jsxs("div",{className:"w-44",children:[e.jsx(i,{className:"text-xs",children:"End Date"}),e.jsx(h,{type:"date",value:H,onChange:s=>{Ne(s.target.value),b(1)},className:"h-10"})]})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-end",children:[(j(x)||w(x))&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full lg:w-56",children:[e.jsx(i,{className:"text-xs",children:"Filter by Creator"}),e.jsxs("select",{value:K,onChange:s=>{ve(s.target.value),b(1)},className:"w-full h-10 rounded-lg border border-gray-300 bg-white px-3 text-sm text-gray-700 focus:border-brand-500 focus:ring focus:ring-brand-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 outline-none transition-all",children:[e.jsx("option",{value:"",children:"All Creators"}),E.map(s=>e.jsx("option",{value:s._id,children:s.fullName},s._id))]})]}),e.jsxs("div",{className:"w-full lg:w-56",children:[e.jsx(i,{className:"text-xs",children:"Filter by Assignee"}),e.jsxs("select",{value:W,onChange:s=>{ke(s.target.value),b(1)},className:"w-full h-10 rounded-lg border border-gray-300 bg-white px-3 text-sm text-gray-700 focus:border-brand-500 focus:ring focus:ring-brand-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 outline-none transition-all",children:[e.jsx("option",{value:"",children:"All Assignees"}),e.jsx("option",{value:"unassigned",children:"Unassigned"}),E.map(s=>e.jsx("option",{value:s._id,children:s.fullName},s._id))]})]})]}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>{ye(""),Ne(""),ve(""),ke(""),he(""),b(1)},className:"h-10",children:"Reset Filters"})]})]}),Oe?e.jsx(us,{}):f.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 gap-4 md:hidden",children:f.map((s,t)=>{var a;return e.jsxs("div",{className:"bg-white dark:bg-white/[0.03] border border-gray-100 dark:border-gray-800 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[(j(x)||w(x))&&e.jsx("input",{type:"checkbox",className:"size-5 rounded border-gray-300 text-brand-500 focus:ring-brand-500 cursor-pointer",checked:u.includes(s._id),onChange:n=>Se(s._id,t,n)}),e.jsxs("span",{className:"text-xs font-bold text-gray-400",children:["#",t+1]}),e.jsx("h3",{className:"font-semibold text-gray-800 dark:text-white",children:s.name||"Unnamed"})]}),Pe(s)]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[s.phoneNumber&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Phone:"}),e.jsx("a",{href:`tel:${s.phoneNumber}`,className:"text-brand-500 hover:underline font-medium",children:s.phoneNumber})]}),s.socialMediaId&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Social:"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:s.socialMediaId})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Assigned:"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:((a=s.assignedTo)==null?void 0:a.fullName)||"Unassigned"})]}),s.source&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Source:"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:s.source})]}),s.purpose&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Purpose:"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:s.purpose})]}),s.remarks&&e.jsxs("div",{className:"mt-2 p-2 bg-gray-50 dark:bg-white/[0.02] rounded text-xs text-gray-600 dark:text-gray-400 italic",children:['"',s.remarks,'"']})]}),e.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-gray-50 dark:border-gray-800",children:[e.jsx("span",{className:"text-[10px] text-gray-400",children:Ie(s.createdAt)}),Me(s)]})]},s._id)})}),e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs(gs,{className:"min-w-[1100px]",children:[e.jsx(hs,{className:"border-gray-200 dark:border-gray-700 border-y bg-gray-50 dark:bg-gray-800/50",children:e.jsxs(Le,{children:[(j(x)||w(x))&&e.jsx(m,{isHeader:!0,className:"py-5 px-4 font-bold text-gray-700 text-start text-sm dark:text-gray-300",children:e.jsx("input",{type:"checkbox",className:"size-5 rounded border-gray-300 text-brand-500 focus:ring-brand-500 cursor-pointer",checked:u.length===f.length&&f.length>0,onChange:ls})}),e.jsx(m,{isHeader:!0,className:"py-5 px-4 font-bold text-gray-700 text-start text-sm dark:text-gray-300 w-16",children:"#"}),e.jsx(m,{isHeader:!0,className:"py-5 px-4 font-bold text-gray-700 text-start text-sm dark:text-gray-300 min-w-[220px]",children:"Contact Details"}),e.jsx(m,{isHeader:!0,className:"py-5 px-4 font-bold text-gray-700 text-start text-sm dark:text-gray-300 min-w-[120px]",children:"Assigned To"}),e.jsx(m,{isHeader:!0,className:"py-5 px-4 font-bold text-gray-700 text-start text-sm dark:text-gray-300 min-w-[140px]",children:"Source / Purpose"}),e.jsx(m,{isHeader:!0,className:"py-5 px-4 font-bold text-gray-700 text-start text-sm dark:text-gray-300 min-w-[200px]",children:"Remarks"}),e.jsx(m,{isHeader:!0,className:"py-5 px-4 font-bold text-gray-700 text-start text-sm dark:text-gray-300 min-w-[140px]",children:"Status"}),e.jsx(m,{isHeader:!0,className:"py-5 px-4 font-bold text-gray-700 text-start text-sm dark:text-gray-300 min-w-[100px]",children:"Actions"})]})}),e.jsx(ps,{className:"divide-y divide-gray-100 dark:divide-gray-800",children:f.map((s,t)=>{var a;return e.jsxs(Le,{className:"transition-colors hover:bg-gray-50 dark:hover:bg-gray-800/30",children:[(j(x)||w(x))&&e.jsx(m,{className:"py-5 px-4",children:e.jsx("input",{type:"checkbox",className:"size-5 rounded border-gray-300 text-brand-500 focus:ring-brand-500 cursor-pointer",checked:u.includes(s._id),onChange:n=>Se(s._id,t,n)})}),e.jsx(m,{className:"py-5 px-4 text-gray-500 text-sm font-semibold",children:(g-1)*50+t+1}),e.jsx(m,{className:"py-5 px-4",children:e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:Ie(s.createdAt)}),e.jsx("div",{className:"text-gray-900 text-base font-bold dark:text-white",children:s.name||"Unnamed"}),s.phoneNumber&&e.jsxs("a",{href:`tel:${s.phoneNumber}`,className:"text-brand-600 hover:text-brand-700 hover:underline font-semibold text-sm flex items-center gap-1.5",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),s.phoneNumber]}),s.socialMediaId&&e.jsxs("div",{className:"text-gray-600 text-xs dark:text-gray-400 flex items-center gap-1.5",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})}),s.socialMediaId]})]})}),e.jsx(m,{className:"py-5 px-4 text-gray-700 text-sm dark:text-gray-300",children:((a=s.assignedTo)==null?void 0:a.fullName)||"Unassigned"}),e.jsx(m,{className:"py-5 px-4",children:e.jsxs("div",{className:"flex flex-col gap-0.5",children:[s.source&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400",children:"Source:"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:s.source})]}),s.purpose&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400",children:"Purpose:"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:s.purpose})]}),!s.source&&!s.purpose&&e.jsx("span",{className:"text-gray-400",children:"-"})]})}),e.jsx(m,{className:"py-5 px-4 text-gray-700 text-sm dark:text-gray-300",children:e.jsx("div",{className:"max-w-[250px]",title:s.remarks,children:s.remarks||"-"})}),e.jsx(m,{className:"py-5 px-4",children:Pe(s)}),e.jsx(m,{className:"py-5 px-4",children:Me(s)})]},s._id)})})]})}),k.totalPages>1&&e.jsxs("div",{className:"mt-6 flex flex-col md:flex-row items-center justify-between gap-4 border-t border-gray-100 dark:border-gray-800 pt-6",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:["Showing ",e.jsx("span",{className:"font-medium",children:(g-1)*50+1})," to ",e.jsx("span",{className:"font-medium",children:Math.min(g*50,k.totalItems)})," of ",e.jsx("span",{className:"font-medium",children:k.totalItems})," results"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{size:"sm",variant:"outline",disabled:g===1,onClick:()=>b(s=>Math.max(1,s-1)),children:"Previous"}),e.jsx("div",{className:"flex items-center gap-1",children:[...Array(k.totalPages)].map((s,t)=>{const a=t+1;return a===1||a===k.totalPages||a>=g-1&&a<=g+1?e.jsx("button",{onClick:()=>b(a),className:`size-8 rounded-lg text-sm font-medium transition-colors ${g===a?"bg-brand-500 text-white":"text-gray-500 hover:bg-gray-100 dark:hover:bg-white/5"}`,children:a},a):a===g-2||a===g+2?e.jsx("span",{className:"px-1 text-gray-400",children:"..."},a):null})}),e.jsx(o,{size:"sm",variant:"outline",disabled:g===k.totalPages,onClick:()=>b(s=>Math.min(k.totalPages,s+1)),children:"Next"})]})]})]}):e.jsxs("div",{className:"text-center py-10",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"No call list entries found."}),e.jsx(o,{variant:"outline",onClick:pe,children:"Add your first entry"})]})]}),e.jsxs(X,{isOpen:Re,onClose:Y,className:"max-w-2xl p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white/90 mb-4",children:"Add Call List Entry"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"name",children:"Name"}),e.jsx(h,{id:"name",type:"text",value:C,onChange:s=>D(s.target.value),placeholder:"Enter name (optional)"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Phone Number"}),e.jsx(Te,{selectPosition:"end",countries:Ue,placeholder:"+91 98765 43210",value:S,onChange:F})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"socialMediaId",children:"Social Media ID"}),e.jsx(h,{id:"socialMediaId",type:"text",value:I,onChange:s=>_(s.target.value),placeholder:"Instagram, Facebook, etc. (optional)"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"source",children:"Source"}),e.jsx(h,{id:"source",type:"text",value:ae,onChange:s=>U(s.target.value),placeholder:"e.g. LinkedIn, Referral (optional)"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"purpose",children:"Purpose"}),e.jsx(h,{id:"purpose",type:"text",value:te,onChange:s=>z(s.target.value),placeholder:"e.g. Sales, Inquiry (optional)"})]}),(j(x)||w(x))&&e.jsxs("div",{children:[e.jsx(i,{htmlFor:"assignedTo",children:"Assign To"}),e.jsxs("select",{id:"assignedTo",value:O,onChange:s=>R(s.target.value),className:"w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 focus:border-brand-500 focus:ring focus:ring-brand-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 shadow-theme-xs outline-none",children:[e.jsx("option",{value:"",children:"Select User (Optional)"}),E.map(s=>e.jsx("option",{value:s._id,children:s.fullName},s._id))]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"remarks",children:"Remarks"}),e.jsx("textarea",{id:"remarks",value:L,onChange:s=>T(s.target.value),placeholder:"Add any notes (optional)",rows:3,className:"w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 focus:border-blue-500 focus:ring focus:ring-blue-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 shadow-theme-xs"})]}),e.jsxs("div",{className:"flex gap-3 justify-end mt-4",children:[e.jsx(o,{variant:"outline",onClick:Y,children:"Cancel"}),e.jsx(o,{variant:"primary",onClick:Ze,loading:B,children:"Add Entry"})]})]})]}),e.jsxs(X,{isOpen:$e,onClose:Z,className:"max-w-2xl p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white/90 mb-4",children:"Edit Call List Entry"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"editName",children:"Name"}),e.jsx(h,{id:"editName",type:"text",value:C,onChange:s=>D(s.target.value),placeholder:"Enter name (optional)"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Phone Number"}),e.jsx(Te,{selectPosition:"end",countries:Ue,placeholder:"+91 98765 43210",value:S,onChange:F})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"editSocialMediaId",children:"Social Media ID"}),e.jsx(h,{id:"editSocialMediaId",type:"text",value:I,onChange:s=>_(s.target.value),placeholder:"Instagram, Facebook, etc. (optional)"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"editSource",children:"Source"}),e.jsx(h,{id:"editSource",type:"text",value:ae,onChange:s=>U(s.target.value),placeholder:"e.g. LinkedIn, Referral (optional)"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"editPurpose",children:"Purpose"}),e.jsx(h,{id:"editPurpose",type:"text",value:te,onChange:s=>z(s.target.value),placeholder:"e.g. Sales, Inquiry (optional)"})]}),(j(x)||w(x))&&e.jsxs("div",{children:[e.jsx(i,{htmlFor:"editAssignedTo",children:"Assign To"}),e.jsxs("select",{id:"editAssignedTo",value:O,onChange:s=>R(s.target.value),className:"w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 focus:border-brand-500 focus:ring focus:ring-brand-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 shadow-theme-xs outline-none",children:[e.jsx("option",{value:"",children:"Select User (Optional)"}),E.map(s=>e.jsx("option",{value:s._id,children:s.fullName},s._id))]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"editRemarks",children:"Remarks"}),e.jsx("textarea",{id:"editRemarks",value:L,onChange:s=>T(s.target.value),placeholder:"Add any notes (optional)",rows:3,className:"w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 focus:border-blue-500 focus:ring focus:ring-blue-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 shadow-theme-xs"})]}),e.jsxs("div",{className:"flex gap-3 justify-end mt-4",children:[e.jsx(o,{variant:"outline",onClick:Z,children:"Cancel"}),e.jsx(o,{variant:"primary",onClick:ss,loading:B,children:"Update Entry"})]})]})]}),e.jsxs(X,{isOpen:Ve,onClose:ee,className:"max-w-md p-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white/90 mb-2",children:"Confirm Delete"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Are you sure you want to delete this call list entry?"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(o,{variant:"outline",onClick:ee,children:"Cancel"}),e.jsx(o,{variant:"danger",onClick:ts,children:"Delete"})]})]}),e.jsxs(X,{isOpen:Ke,onClose:se,className:"max-w-xl p-0 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 dark:border-gray-800",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white/90",children:"Import Call List"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Upload a CSV file to bulk import call list entries."})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-brand-50/50 dark:bg-brand-500/5 p-4 rounded-xl border border-brand-100 dark:border-brand-500/20 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-brand-700 dark:text-brand-400",children:"Step 1: Get the template"}),e.jsx("p",{className:"text-xs text-brand-600/80 dark:text-brand-400/60 mt-0.5",children:"Use our CSV template to ensure correct data formatting."})]}),e.jsx(o,{size:"sm",variant:"outline",className:"bg-white dark:bg-gray-900",onClick:()=>{const a="data:text/csv;charset=utf-8,"+[["Name","Phone Number","Social Media ID","Remarks"],...[["John Doe","9876543210","john_insta","Very interested"],["Jane Smith","9123456789","jane_fb","Follow up next week"]]].map(M=>M.join(",")).join(`
`),n=encodeURI(a),d=document.createElement("a");d.setAttribute("href",n),d.setAttribute("download","call_list_template.csv"),document.body.appendChild(d),d.click(),document.body.removeChild(d)},children:"Download Sample"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Step 2: Upload your file"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-200 dark:border-gray-800 rounded-2xl p-10 flex flex-col items-center justify-center text-center hover:border-brand-300 dark:hover:border-brand-800 transition-colors cursor-pointer group",onClick:()=>document.getElementById("csv-upload-calllist").click(),children:[e.jsx("div",{className:"size-12 rounded-full bg-gray-50 dark:bg-gray-800 flex items-center justify-center mb-4 group-hover:bg-brand-50 dark:group-hover:bg-brand-500/10 transition-colors",children:e.jsx(bs,{className:"size-6 text-gray-400 group-hover:text-brand-500 rotate-180"})}),e.jsx("p",{className:"text-sm font-medium text-gray-800 dark:text-white/90",children:"Click to upload or drag and drop"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Only CSV files are supported"}),e.jsx("input",{type:"file",id:"csv-upload-calllist",className:"hidden",accept:".csv",onChange:s=>{const t=s.target.files[0];if(t){if(t.type!=="text/csv"&&!t.name.endsWith(".csv")){l.error("Please upload a valid CSV file");return}l.info(`Selected ${t.name}`)}}})]})]}),e.jsxs("div",{className:"flex gap-3 p-4 bg-gray-50 dark:bg-white/[0.02] rounded-xl border border-gray-100 dark:border-gray-800",children:[e.jsx("div",{className:"size-5 rounded-full bg-blue-500 flex items-center justify-center shrink-0 mt-0.5",children:e.jsx("span",{className:"text-[10px] text-white font-bold",children:"i"})}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 leading-relaxed",children:[e.jsx("p",{className:"font-semibold text-gray-700 dark:text-gray-300 mb-1",children:"Important Notes:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"At least one field (Name, Phone, or Social Media ID) is mandatory for each row."}),e.jsx("li",{children:"Remarks can be left empty."})]})]})]})]})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 dark:bg-white/[0.02] border-t border-gray-100 dark:border-gray-800 flex items-center justify-end gap-3",children:[e.jsx(o,{variant:"outline",onClick:se,children:"Cancel"}),e.jsx(o,{variant:"primary",loading:B,onClick:()=>{const s=document.getElementById("csv-upload-calllist");if(s.files.length===0){l.error("Please select a file first");return}p(!0);const t=s.files[0];ys.parse(t,{header:!0,skipEmptyLines:!0,complete:async a=>{var De,Fe;const n=(c,ds)=>{if(!c)return null;const is=c.map(me=>me.toLowerCase().trim());for(const me of ds){const _e=is.indexOf(me.toLowerCase());if(_e!==-1)return c[_e]}return null},d=a.meta.fields||[];console.log("CSV Headers:",d);const M=n(d,["Name","Full Name","Lead Name"]),q=n(d,["Phone Number","Phone","Mobile","Contact"]),G=n(d,["Social Media ID","Social Media","Social","Instagram","Facebook"]),Ae=n(d,["Remarks","Note","Comment"]),Ee=a.data.map(c=>({name:M?c[M]:"",phoneNumber:q?c[q]:"",socialMediaId:G?c[G]:"",remarks:Ae?c[Ae]:""})).filter(c=>c.name||c.phoneNumber||c.socialMediaId);if(Ee.length===0){l.error("No valid entries found in file. Check Name, Phone, or Social Media ID columns."),p(!1);return}try{const c=await y.post(`${N}/call-lists/import`,{entries:Ee},{withCredentials:!0});l.success(c.data.message||"Import successful!"),ce(),se()}catch(c){console.error("Import failed:",c),l.error(((Fe=(De=c.response)==null?void 0:De.data)==null?void 0:Fe.message)||"Import failed. Please try again.")}finally{p(!1)}},error:a=>{console.error("CSV Parse Error:",a),l.error("Failed to parse CSV file."),p(!1)}})},children:"Confirm Import"})]})]}),e.jsx(fs,{position:"top-center",autoClose:3e3,className:"!z-[999999]",style:{zIndex:999999}})]})}export{Ms as default};
